# Driver Activity Recognition - Configuration
# CNN+LSTM pipeline for Drive&Act dataset (Kinect IR)

data:
  root: "./data"                    # Local path (override for Colab)
  annotation_dir: "activities_3s/kinect_ir"
  annotation_file: "midlevel.chunks_90.csv"
  video_dir: "kinect_ir"
  split: 0                          # Which pre-defined split to use (0, 1, or 2)
  view: "kinect_ir"
  min_segment_frames: 8             # Filter segments shorter than this

model:
  backbone: "resnet18"
  feature_dim: 512                  # ResNet-18 output dimension
  lstm_hidden: 256
  lstm_layers: 2
  lstm_dropout: 0.5                  # Increased from 0.3 for regularization
  fc_dropout: 0.5
  num_classes: 34                   # Will be overridden by actual data count
  freeze_cnn: true
  use_layernorm: true               # LayerNorm on LSTM input
  bidirectional: true               # Bidirectional LSTM
  pooling: "attention"              # "last" | "mean" | "attention"

training:
  batch_size: 32
  lr: 0.001
  weight_decay: 0.0005              # Increased from 1e-4 for regularization
  epochs: 80                        # Increased from 50
  early_stop_patience: 15           # Increased from 10
  label_smoothing: 0.1
  loss_type: "focal"                # "ce" | "focal"
  focal_gamma: 2.0                  # Focal loss focusing parameter
  mixup_alpha: 0.2                  # Mixup interpolation strength (0 = disabled)
  noise_std: 0.1                    # Gaussian noise on input features
  gradient_clip: 1.0
  scheduler_factor: 0.5
  scheduler_patience: 5
  num_workers: 4
  seed: 42

processing:
  seq_length: 16                    # Number of frames per sequence
  frame_size: 224
  original_fps: 30
  sample_fps: 5                     # Temporal subsampling rate
  imagenet_mean: [0.485, 0.456, 0.406]
  imagenet_std: [0.229, 0.224, 0.225]

features:
  save_dir: "features"              # Relative to data.root
  dtype: "float16"                  # Save as float16 to reduce disk usage

output:
  checkpoint_dir: "results/checkpoints"
  log_dir: "results/logs"
  figure_dir: "results/figures"
